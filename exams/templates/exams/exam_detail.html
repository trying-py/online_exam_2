{% extends "base.html" %}

{% block title %}جزئیات آزمون{% endblock %}

{% block content %}
  <a href="{% url 'exams:exam_list' %}" class="btn btn-outline-secondary mb-3">بازگشت</a>

  <div class="card p-4 mb-4 shadow-sm">
    <h2 class="h4 mb-1">{{ exam.title }}</h2>
    <p class="text-muted mb-2">موضوع: {{ exam.subject }}</p>
    <div class="row g-2 text-muted small">
      <div class="col-12 col-md-4"><strong>امتیاز کل:</strong> {{ exam.total_score }}</div>
      <div class="col-12 col-md-4"><strong>شروع:</strong> {{ exam.start_time|date:"Y-m-d H:i" }}</div>
      <div class="col-12 col-md-4"><strong>مدت:</strong> {{ exam.duration_minutes }} دقیقه</div>
    </div>
    <div class="mt-2 text-muted small">مدرس: {{ exam.instructor.username }}</div>

    <div class="mt-3 d-flex gap-2 flex-wrap">
      {% if user.is_authenticated and user.role == 'student' %}
        <a class="btn btn-success" href="{% url 'questions:take_exam' exam.id %}">شرکت در آزمون</a>
      {% endif %}
      {% if user.is_authenticated and user.role == 'instructor' and user == exam.instructor %}
        <a class="btn btn-primary" href="{% url 'questions:question_create_for_exam' exam.id %}">افزودن سوال</a>
      {% endif %}
    </div>
  </div>

  <div class="card p-3 shadow-sm">
    <h3 class="h5 mb-3">سوالات آزمون</h3>
    {% if questions %}
      <ol class="list-group list-group-numbered">
        {% for q in questions %}
          <li class="list-group-item d-flex justify-content-between align-items-start">
            <div class="ms-2 me-auto">
              <div class="fw-bold">{{ q.text }}</div>
              <div class="small text-muted">امتیاز: {{ q.score }}</div>
            </div>
            <span class="badge text-bg-info rounded-pill">{{ q.get_question_type_display }}</span>
          </li>
        {% endfor %}
      </ol>
    {% else %}
      <p class="text-muted mb-0">هیچ سوالی برای این آزمون تعریف نشده است.</p>
    {% endif %}
  </div>
{% endblock %}